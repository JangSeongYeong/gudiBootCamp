<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.gudi.dao.MemberDAO">
	
<!-- else 가 없다.
	<insert id="join" parameterType="member">
		INSERT INTO member (id, pw, name, age, gender, email)
		<if test="!email.equals('')">
			VALUES(#{id}, #{pw}, #{name}, #{age}, #{gender}, #{email})		
		</if>
		<if test="email.equals('')">
			VALUES(#{id}, #{pw}, #{name}, #{age}, #{gender}, '없음')		
		</if>
	</insert>
 -->
	
 	<insert id="join" parameterType="member">
 		INSERT INTO member (id, pw, name, age, gender, email)
 		<choose>
 			<when test="!email.equals('')">
 				VALUES(#{id}, #{pw}, #{name}, #{age}, #{gender}, #{email})		
 			</when>
 			<otherwise>
 				VALUES(#{id}, #{pw}, #{name}, #{age}, #{gender}, '없음')
 			</otherwise>
 		</choose>
 	</insert>

	<!-- 
		[MS-SQL] '%'+#{keyword}+'%'
		[ORACLE] '%'||#{keyword}||'%' 
		[MYSQL] CONCAT('%',#{keyword},'%') 
	-->
	
	<!-- where 태그는 if  에 해당되는 내용이 없을 땐 동작하지 않고, 있을 경우 WHERE  문을 넣어준다. --> 
	<select id="list" parameterType="map" resultType="member">
		SELECT * FROM member 
			<where>
				<if test="opt=='id' and !keyword.equals('')">id LIKE CONCAT('%',#{keyword},'%')</if>
				<if test="opt=='name' and !keyword.equals('')">name LIKE CONCAT('%',#{keyword},'%')</if>
				<if test="opt=='email' and !keyword.equals('')">email LIKE CONCAT('%',#{keyword},'%')</if>
			</where> 
	</select>
	
	
</mapper>